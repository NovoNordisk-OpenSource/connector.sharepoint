<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ConnectorSharepoint • connector.sharepoint</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ConnectorSharepoint">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">connector.sharepoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/connector_sharepoint.html">ConnectorSharepoint</a></li>
    <li><a class="dropdown-item" href="../articles/Consistent-API.html">Understanding Connector Package Methods</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/novonordisk-opensource/connector.sharepoint/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ConnectorSharepoint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/novonordisk-opensource/connector.sharepoint/blob/feat/codecov/vignettes/connector_sharepoint.Rmd" class="external-link"><code>vignettes/connector_sharepoint.Rmd</code></a></small>
      <div class="d-none name"><code>connector_sharepoint.Rmd</code></div>
    </div>

    
    
<p>The connector.sharepoint package provides a convenient interface for
accessing and interacting with Microsoft SharePoint sites directly from
R.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will guide you through the process of connecting to a
SharePoint site, retrieving data, and performing various operations
using this package.</p>
</div>
<div class="section level2">
<h2 id="connecting-to-a-sharepoint-site">Connecting to a SharePoint Site<a class="anchor" aria-label="anchor" href="#connecting-to-a-sharepoint-site"></a>
</h2>
<div class="section level3">
<h3 id="without-connector-package">Without connector package<a class="anchor" aria-label="anchor" href="#without-connector-package"></a>
</h3>
<p>To get started, you need to establish a connection to your SharePoint
site. Use the <code><a href="../reference/ConnectorSharepoint.html">ConnectorSharepoint()</a></code> function to
authenticate and connect to your SharePoint site. Here’s an example of
how to do this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/novonordisk-opensource/connector.sharepoint" class="external-link">connector.sharepoint</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to SharePoint</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connector_sharepoint.html">connector_sharepoint</a></span><span class="op">(</span>site_url <span class="op">=</span> <span class="st">"sharepoint_url"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="with-connector-package-recommended">With connector package (recommended)<a class="anchor" aria-label="anchor" href="#with-connector-package-recommended"></a>
</h3>
<p>If you are using the connector package, you can connect to a
SharePoint site using the <code><a href="https://novonordisk-opensource.github.io/connector/reference/connect.html" class="external-link">connect()</a></code> function. This function
based on a configuration file or a list creates a
<code><a href="https://novonordisk-opensource.github.io/connector/reference/connectors.html" class="external-link">connectors()</a></code> object with a <code>connector</code>for each
of the specified datasources (for detailed explanation have a look at
connector package).</p>
<p>Configuration file for connecting to SharePoint should look like
this:</p>
<p>Save this to <code>_connector.yml</code> file and use the
<code><a href="https://novonordisk-opensource.github.io/connector/reference/connect.html" class="external-link">connect()</a></code> function to connect to SharePoint:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://novonordisk-opensource.github.io/connector/" class="external-link">connector</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create connector object</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://novonordisk-opensource.github.io/connector/reference/connect.html" class="external-link">connect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now you can access the SharePoint site using the <code>db</code>
object and <code>adam</code> field inside of it.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Connection to SharePoint site. This will print object details</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span></span></code></pre></div>
<p>After the setup is done we can use this connection to manipulate
Sharepoint data.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-and-writing-data">Reading and writing data<a class="anchor" aria-label="anchor" href="#reading-and-writing-data"></a>
</h2>
<p>The <code>connector</code> packages provide a set of functions to
read and write data from the datasources. They all have similar
interface, so it’s easy to switch between them.</p>
<p>Now, we will show how to read and write different types data from/to
Sharepoint. In these examples we will be using <code>iris</code> and
<code>mtcars</code> datasets.</p>
<p>Here is an example of writing data to the ADaM table:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manipulate data</span></span>
<span></span>
<span><span class="co">## Iris data</span></span>
<span><span class="va">setosa</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"setosa"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mean_for_all_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">median</span>, <span class="va">sd</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## mtcars data</span></span>
<span><span class="va">cars</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fl">22</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mean_for_all_mtcars</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gear</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mean"</span> <span class="op">=</span> <span class="va">mean</span>, <span class="st">"median"</span> <span class="op">=</span> <span class="va">median</span>, <span class="st">"sd"</span> <span class="op">=</span> <span class="va">sd</span>, <span class="st">"min"</span> <span class="op">=</span> <span class="va">min</span>, <span class="st">"max"</span> <span class="op">=</span> <span class="va">max</span><span class="op">)</span>,</span>
<span>      .names <span class="op">=</span> <span class="st">"{.col}_{.fn}"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">gear</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"stat"</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Store data</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">setosa</span>, <span class="st">"setosa"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">mean_for_all_iris</span>, <span class="st">"mean_iris"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"cars_mpg"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">mean_for_all_mtcars</span>, <span class="st">"mean_mtcars"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s read the data back manipulate it a bit and write it to the
SharePoint. This way we can save different types of data in different
formats.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List and load data</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_cnt.html">read_cnt</a></span><span class="op">(</span><span class="st">"mean_mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gttable</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="op">(</span>groupname_col <span class="op">=</span> <span class="st">"gear"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save nontabular data to sharepoint</span></span>
<span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".docx"</span><span class="op">)</span></span>
<span><span class="fu">gtsave</span><span class="op">(</span><span class="va">gttable</span>, <span class="va">tmp_file</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/upload_cnt.html">upload_cnt</a></span><span class="op">(</span><span class="va">tmp_file</span>, <span class="st">"tmeanallmtcars.docx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manipulate data</span></span>
<span><span class="va">setosa_fsetosa</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="va">adam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/read_cnt.html">read_cnt</a></span><span class="op">(</span><span class="st">"setosa"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fsetosa</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">setosa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Store data into output location</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">fsetosa</span><span class="op">$</span><span class="va">data</span>, <span class="st">"fsetosa.csv"</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="va">fsetosa</span>, <span class="st">"fsetosa.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">tmp_file</span>, <span class="va">fsetosa</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">upload</span><span class="op">(</span><span class="va">tmp_file</span>, <span class="st">"fsetosa.png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this vignette we showed how to connect to SharePoint site, read
and write data from it. We also showed how to use the connector package
to connect to SharePoint and how to manipulate data using the connector
package.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cervan Girard, Vladimir Obucina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
